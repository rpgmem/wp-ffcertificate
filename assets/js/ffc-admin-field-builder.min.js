!function(e,l){"use strict";var a=0;var t,f=[{value:"text",label:(t="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).textField||"Text Field"},{value:"email",label:t.email||"Email"},{value:"number",label:t.number||"Number"},{value:"textarea",label:t.textarea||"Textarea"},{value:"select",label:t.dropdownSelect||"Dropdown Select"},{value:"checkbox",label:t.checkbox||"Checkbox"},{value:"radio",label:t.radioButtons||"Radio Buttons"},{value:"date",label:t.date||"Date"}];function i(l){a++;var t="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{},i=t.remove||"Remove",d=t.fieldType||"Field Type:",o=t.label||"Label:",c=t.fieldLabel||"Field Label",s=t.nameVariable||"Name (variable):",r=t.fieldName||"field_name",u=t.required||"Required:",p=t.options||"Options:",m=t.separateWithCommas||"Separate with commas",b='<div class="ffc-field-row" data-index="'+a+'">';b+='  <div class="ffc-field-row-header">',b+='    <span class="ffc-sort-handle">',b+='      <span class="dashicons dashicons-menu"></span>',b+='      <span class="ffc-field-title"><strong>'+l.toUpperCase()+"</strong></span>",b+="    </span>",b+='    <button type="button" class="button button-link-delete ffc-remove-field">'+i+"</button>",b+="  </div>",b+='  <div class="ffc-field-row-body">',b+='    <table class="form-table">',b+="      <tr>",b+="        <th><label>"+d+"</label></th>",b+='        <td><select class="ffc-field-type" name="ffc_fields['+a+'][type]">',f.forEach(function(e){var a=e.value===l?" selected":"";b+='<option value="'+e.value+'"'+a+">"+e.label+"</option>"}),b+="        </select></td>",b+="      </tr>",b+="      <tr>",b+="        <th><label>"+o+"</label></th>",b+='        <td><input type="text" class="ffc-field-label regular-text" name="ffc_fields['+a+'][label]" placeholder="'+c+'"></td>',b+="      </tr>",b+="      <tr>",b+="        <th><label>"+s+"</label></th>",b+='        <td><input type="text" class="ffc-field-name regular-text" name="ffc_fields['+a+'][name]" placeholder="'+r+'"></td>',b+="      </tr>",b+="      <tr>",b+="        <th><label>"+u+"</label></th>",b+='        <td><input type="checkbox" class="ffc-field-required" name="ffc_fields['+a+'][required]" value="1"></td>',b+="      </tr>","select"!==l&&"radio"!==l&&"checkbox"!==l||(b+="      <tr>",b+="        <th><label>"+p+"</label></th>",b+='        <td><textarea class="ffc-field-options large-text" name="ffc_fields['+a+'][options]" rows="3" placeholder="'+m+'"></textarea></td>',b+="      </tr>"),b+="    </table>",b+="  </div>",b+="</div>",e("#ffc-fields-container").append(b),n(),console.log("[FFC] Field added:",l)}function n(){var l=[];e("#ffc-fields-container .ffc-field-row").each(function(){var a=e(this),t={type:a.find(".ffc-field-type").val(),label:a.find(".ffc-field-label").val(),name:a.find(".ffc-field-name").val(),required:a.find(".ffc-field-required").is(":checked"),options:a.find(".ffc-field-options").val()};l.push(t)});var a=e("#ffc-form-fields-json");a.length||(a=e('input[name="ffc_form_fields"], textarea[name="ffc_form_fields"]')),a.length?(a.val(JSON.stringify(l)),console.log("[FFC] Fields JSON updated:",l.length,"fields")):console.warn("[FFC] JSON field not found")}window.FFC=window.FFC||{},window.FFC.Admin=window.FFC.Admin||{},window.FFC.Admin.FieldBuilder={init:function(){console.log("[FFC] Initializing Form Builder..."),0!==e("#ffc-fields-container").length?(a=e("#ffc-fields-container .ffc-field-row").length,console.log("[FFC] Found",a,"existing fields"),e(document).on("click",".ffc-add-field",function(l){l.preventDefault(),console.log("[FFC] Add Field clicked"),function(l){e(".ffc-field-type-menu").remove();var a=e('<div class="ffc-field-type-menu"></div>'),t="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.chooseFieldType?ffc_ajax.strings.chooseFieldType:"Choose Field Type:";a.append('<div class="ffc-menu-header">'+t+"</div>");var n=e("<ul></ul>");f.forEach(function(l){var t=e('<li data-type="'+l.value+'">'+l.label+"</li>");t.on("click",function(){i(l.value),a.remove()}),n.append(t)}),a.append(n);var d=l.offset(),o=l.outerHeight();a.css({position:"absolute",top:d.top+o+5+"px",left:d.left+"px",zIndex:99999,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",minWidth:"200px"}),e("body").append(a),setTimeout(function(){e(document).one("click",function(){a.remove()})},100),console.log("[FFC] Field type menu shown")}(e(this))}),e(document).on("click",".ffc-remove-field",function(l){l.preventDefault();var a="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.confirmDeleteField?ffc_ajax.strings.confirmDeleteField:"Remove this field?";confirm(a)&&e(this).closest(".ffc-field-row").fadeOut(300,function(){e(this).remove(),n(),console.log("[FFC] Field removed")})}),e("#ffc-fields-container").on("change input","input, select, textarea",function(){n()}),e.fn.sortable&&e("#ffc-fields-container").sortable({handle:".ffc-sort-handle",placeholder:"ffc-field-placeholder",update:function(){n(),console.log("[FFC] Fields reordered")}})):console.log("[FFC] Fields container not found")},addField:i,updateJSON:n},l.registerModule&&l.registerModule("Admin.FieldBuilder",l.version)}(jQuery,window.FFC);