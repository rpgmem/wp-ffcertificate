!function(e,l){"use strict";var t=0;var f,a=[{value:"text",label:(f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).textField||"Text Field"},{value:"email",label:f.email||"Email"},{value:"number",label:f.number||"Number"},{value:"textarea",label:f.textarea||"Textarea"},{value:"select",label:f.dropdownSelect||"Dropdown Select"},{value:"checkbox",label:f.checkbox||"Checkbox"},{value:"radio",label:f.radioButtons||"Radio Buttons"},{value:"date",label:f.date||"Date"},{value:"info",label:f.infoBlock||"Info Block"},{value:"embed",label:f.embedMedia||"Embed (Media)"}];function i(l){t++;var f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{},i=f.remove||"Remove",d=f.fieldType||"Field Type:",o=f.label||"Label:",c=f.fieldLabel||"Field Label",s=f.nameVariable||"Name (variable):",r=f.fieldName||"field_name",u=f.required||"Required:",p=f.options||"Options:",b=f.separateWithCommas||"Separate with commas",m=f.content||"Content:",h=f.contentPlaceholder||"Text to display. Supports <b>, <i>, <a>.",v=f.titleOptional||"Title (optional):",g=f.embedUrl||"Media URL:",F=f.embedUrlPlaceholder||"https://www.youtube.com/watch?v=... or image URL",x=f.captionOptional||"Caption (optional):",w="info"===l,y="embed"===l,_=w||y,C='<div class="ffc-field-row" data-index="'+t+'">';C+='  <div class="ffc-field-row-header">',C+='    <span class="ffc-sort-handle">',C+='      <span class="dashicons dashicons-menu"></span>',C+='      <span class="ffc-field-title"><strong>'+l.toUpperCase()+"</strong></span>",C+="    </span>",C+='    <button type="button" class="button button-link-delete ffc-remove-field">'+i+"</button>",C+="  </div>",C+='  <div class="ffc-field-row-body">',C+='    <table class="form-table">',C+="      <tr>",C+="        <th><label>"+d+"</label></th>",C+='        <td><select class="ffc-field-type" name="ffc_fields['+t+'][type]">',a.forEach(function(e){var t=e.value===l?" selected":"";C+='<option value="'+e.value+'"'+t+">"+e.label+"</option>"}),C+="        </select></td>",C+="      </tr>",C+='      <tr class="ffc-content-row"'+(w?"":' style="display:none"')+">",C+="        <th><label>"+m+"</label></th>",C+='        <td><textarea class="ffc-field-content large-text" name="ffc_fields['+t+'][content]" rows="4" placeholder="'+h+'"></textarea></td>',C+="      </tr>",C+='      <tr class="ffc-embed-row"'+(y?"":' style="display:none"')+">",C+="        <th><label>"+g+"</label></th>",C+='        <td><input type="url" class="ffc-field-embed-url regular-text" name="ffc_fields['+t+'][embed_url]" placeholder="'+F+'"></td>',C+="      </tr>",C+="      <tr>",C+="        <th><label>"+(w?v:y?x:o)+"</label></th>",C+='        <td><input type="text" class="ffc-field-label regular-text" name="ffc_fields['+t+'][label]" placeholder="'+c+'"></td>',C+="      </tr>",C+='      <tr class="ffc-standard-row"'+(_?' style="display:none"':"")+">",C+="        <th><label>"+s+"</label></th>",C+='        <td><input type="text" class="ffc-field-name regular-text" name="ffc_fields['+t+'][name]" placeholder="'+r+'"></td>',C+="      </tr>",C+='      <tr class="ffc-standard-row"'+(_?' style="display:none"':"")+">",C+="        <th><label>"+u+"</label></th>",C+='        <td><input type="checkbox" class="ffc-field-required" name="ffc_fields['+t+'][required]" value="1"></td>',C+="      </tr>","select"!==l&&"radio"!==l&&"checkbox"!==l||(C+="      <tr>",C+="        <th><label>"+p+"</label></th>",C+='        <td><textarea class="ffc-field-options large-text" name="ffc_fields['+t+'][options]" rows="3" placeholder="'+b+'"></textarea></td>',C+="      </tr>"),C+="    </table>",C+="  </div>",C+="</div>",e("#ffc-fields-container").append(C),n(),console.log("[FFC] Field added:",l)}function n(){var l=[];e("#ffc-fields-container .ffc-field-row").each(function(){var t=e(this),f={type:t.find(".ffc-field-type").val(),label:t.find(".ffc-field-label").val(),name:t.find(".ffc-field-name").val(),required:t.find(".ffc-field-required").is(":checked"),options:t.find(".ffc-field-options").val(),content:t.find(".ffc-field-content").val()||"",embed_url:t.find(".ffc-field-embed-url").val()||""};l.push(f)});var t=e("#ffc-form-fields-json");t.length||(t=e('input[name="ffc_form_fields"], textarea[name="ffc_form_fields"]')),t.length?(t.val(JSON.stringify(l)),console.log("[FFC] Fields JSON updated:",l.length,"fields")):console.warn("[FFC] JSON field not found")}window.FFC=window.FFC||{},window.FFC.Admin=window.FFC.Admin||{},window.FFC.Admin.FieldBuilder={init:function(){console.log("[FFC] Initializing Form Builder..."),0!==e("#ffc-fields-container").length?(t=e("#ffc-fields-container .ffc-field-row").length,console.log("[FFC] Found",t,"existing fields"),e(document).on("click",".ffc-add-field",function(l){l.preventDefault(),console.log("[FFC] Add Field clicked"),function(l){e(".ffc-field-type-menu").remove();var t=e('<div class="ffc-field-type-menu"></div>'),f="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.chooseFieldType?ffc_ajax.strings.chooseFieldType:"Choose Field Type:";t.append('<div class="ffc-menu-header">'+f+"</div>");var n=e("<ul></ul>");a.forEach(function(l){var f=e('<li data-type="'+l.value+'">'+l.label+"</li>");f.on("click",function(){i(l.value),t.remove()}),n.append(f)}),t.append(n);var d=l.offset(),o=l.outerHeight();t.css({position:"absolute",top:d.top+o+5+"px",left:d.left+"px",zIndex:99999,background:"#fff",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 8px rgba(0,0,0,0.15)",minWidth:"200px"}),e("body").append(t),setTimeout(function(){e(document).one("click",function(){t.remove()})},100),console.log("[FFC] Field type menu shown")}(e(this))}),e(document).on("click",".ffc-remove-field",function(l){l.preventDefault();var t="undefined"!=typeof ffc_ajax&&ffc_ajax.strings&&ffc_ajax.strings.confirmDeleteField?ffc_ajax.strings.confirmDeleteField:"Remove this field?";confirm(t)&&e(this).closest(".ffc-field-row").fadeOut(300,function(){e(this).remove(),n(),console.log("[FFC] Field removed")})}),e("#ffc-fields-container").on("change input","input, select, textarea",function(){n()}),e("#ffc-fields-container").on("change",".ffc-field-type",function(){var l=e(this).closest(".ffc-field-row"),t=e(this).val(),f="info"===t,a="embed"===t,i=f||a;l.find(".ffc-content-row").toggle(f),l.find(".ffc-embed-row").toggle(a),l.find(".ffc-standard-row").toggle(!i),l.find(".ffc-options-field").toggle("select"===t||"radio"===t||"checkbox"===t)}),e("#ffc-fields-container").on("change",".ffc-field-type-selector",function(){var l=e(this).closest(".ffc-field-row"),t=e(this).val(),f="info"===t,a="embed"===t,i=f||a;l.find(".ffc-content-field").toggleClass("ffc-hidden",!f),l.find(".ffc-embed-field").toggleClass("ffc-hidden",!a),l.find(".ffc-standard-row").toggleClass("ffc-hidden",i),l.find(".ffc-options-field").toggleClass("ffc-hidden",!("select"===t||"radio"===t||"checkbox"===t))}),e.fn.sortable&&e("#ffc-fields-container").sortable({handle:".ffc-sort-handle",placeholder:"ffc-field-placeholder",update:function(){n(),console.log("[FFC] Fields reordered")}})):console.log("[FFC] Fields container not found")},addField:i,updateJSON:n},l.registerModule&&l.registerModule("Admin.FieldBuilder",l.version)}(jQuery,window.FFC);