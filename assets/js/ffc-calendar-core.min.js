!function(t){"use strict";window.FFCCalendarCore=function(e,n){if(e&&e.length){this.$container=e;var s=n.legendItems||null;s&&delete n.legendItems,this.options=t.extend(!0,{},{onDayClick:null,onMonthChange:null,getDayContent:null,getDayClasses:null,showLegend:!0,showFilters:!1,showTodayButton:!0,minDate:null,maxDate:null,disabledDays:[],holidays:{},strings:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],today:"Today",holiday:"Holiday",closed:"Closed",available:"Available",booked:"Booked"},legendItems:[{class:"ffc-available",label:"Available"},{class:"ffc-booked",label:"Booked"},{class:"ffc-holiday",label:"Holiday"},{class:"ffc-closed",label:"Closed"}]},n),s&&(this.options.legendItems=s),this.currentDate=new Date,this.selectedDate=null,this.init()}else console.error("FFCCalendarCore: Container element not found")},FFCCalendarCore.prototype={init:function(){this.render(),this.bindEvents()},render:function(){var t='<div class="ffc-calendar-core">';t+='<div class="ffc-calendar-header">',t+='<div class="ffc-calendar-nav">',t+='<button type="button" class="ffc-nav-btn ffc-prev-month">&lsaquo;</button>',t+='<h2 class="ffc-current-month"></h2>',t+='<button type="button" class="ffc-nav-btn ffc-next-month">&rsaquo;</button>',this.options.showTodayButton&&(t+='<button type="button" class="ffc-nav-btn ffc-today-btn">'+this.options.strings.today+"</button>"),t+="</div>",this.options.showFilters&&(t+='<div class="ffc-calendar-filters"></div>'),t+="</div>",t+='<div class="ffc-calendar-grid">',t+='<div class="ffc-calendar-weekdays">';for(var e=0;e<7;e++)t+='<div class="ffc-weekday">'+this.options.strings.weekdays[e]+"</div>";if(t+="</div>",t+='<div class="ffc-calendar-days"></div>',t+="</div>",this.options.showLegend){t+='<div class="ffc-calendar-legend">';for(var n=0;n<this.options.legendItems.length;n++){var s=this.options.legendItems[n];t+='<div class="ffc-legend-item">',t+='<span class="ffc-legend-dot '+s.class+'"></span>',t+="<span>"+s.label+"</span>",t+="</div>"}t+="</div>"}t+="</div>",this.$container.html(t),this.$days=this.$container.find(".ffc-calendar-days"),this.$month=this.$container.find(".ffc-current-month"),this.renderDays()},bindEvents:function(){var e=this;this.$container.on("click",".ffc-prev-month",function(){e.prevMonth()}),this.$container.on("click",".ffc-next-month",function(){e.nextMonth()}),this.$container.on("click",".ffc-today-btn",function(){e.goToToday()}),this.$container.on("click",".ffc-day:not(.ffc-disabled):not(.ffc-other-month)",function(){var n=t(this).data("date");e.selectDate(n),"function"==typeof e.options.onDayClick&&e.options.onDayClick(n,t(this))})},renderDays:function(){var t=this.currentDate.getFullYear(),e=this.currentDate.getMonth();this.$month.text(this.options.strings.months[e]+" "+t);var n=new Date(t,e,1),s=new Date(t,e+1,0),a=n.getDay(),i=s.getDate(),o=new Date(t,e,0).getDate(),c="",r=1,f=1,d=new Date;d.setHours(0,0,0,0);for(var l=0;l<6;l++)for(var h=0;h<7;h++){var u,y,p=["ffc-day"],D=!1;0===l&&h<a?(y=o-a+h+1,u=new Date(t,e-1,y),p.push("ffc-other-month"),D=!0):r>i?(y=f++,u=new Date(t,e+1,y),p.push("ffc-other-month"),D=!0):(y=r++,u=new Date(t,e,y));var v=this.formatDate(u);u<d&&p.push("ffc-past"),u.getTime()===d.getTime()&&p.push("ffc-today"),this.options.minDate&&u<this.options.minDate&&p.push("ffc-disabled"),this.options.maxDate&&u>this.options.maxDate&&p.push("ffc-disabled");var g=u.getDay();-1!==this.options.disabledDays.indexOf(g)&&(p.push("ffc-closed"),p.push("ffc-disabled"));var b=this.options.holidays[v];if(b&&(p.push("ffc-holiday"),p.push("ffc-disabled")),this.selectedDate===v&&p.push("ffc-selected"),"function"==typeof this.options.getDayClasses&&!D){var m=this.options.getDayClasses(v,u);m&&(p=p.concat(m))}c+='<div class="'+p.join(" ")+'" data-date="'+v+'">',c+='<span class="ffc-day-number">'+y+"</span>",c+='<div class="ffc-day-content">',"function"!=typeof this.options.getDayContent||D?b&&(c+='<span class="ffc-day-badge ffc-badge-holiday">'+("string"==typeof b?b:this.options.strings.holiday)+"</span>"):c+=this.options.getDayContent(v,u,b),c+="</div>",c+="</div>"}this.$days.html(c),"function"==typeof this.options.onMonthChange&&this.options.onMonthChange(t,e+1)},prevMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()-1),this.renderDays()},nextMonth:function(){this.currentDate.setMonth(this.currentDate.getMonth()+1),this.renderDays()},goToToday:function(){this.currentDate=new Date,this.renderDays()},goToDate:function(t){if("string"==typeof t){var e=t.split("-");this.currentDate=new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]))}else this.currentDate=new Date(t);this.renderDays()},selectDate:function(t){this.selectedDate=t,this.$days.find(".ffc-day").removeClass("ffc-selected"),this.$days.find('.ffc-day[data-date="'+t+'"]').addClass("ffc-selected")},clearSelection:function(){this.selectedDate=null,this.$days.find(".ffc-day").removeClass("ffc-selected")},setOptions:function(e){this.options=t.extend(this.options,e),this.renderDays()},setHolidays:function(t){this.options.holidays=t,this.renderDays()},setDisabledDays:function(t){this.options.disabledDays=t,this.renderDays()},refresh:function(){this.renderDays()},formatDate:function(t){var e=t.getFullYear(),n=t.getMonth()+1,s=t.getDate();return e+"-"+(n<10?"0":"")+n+"-"+(s<10?"0":"")+s},parseDate:function(t){var e=t.split("-");return new Date(parseInt(e[0]),parseInt(e[1])-1,parseInt(e[2]))},getCurrentMonth:function(){return{year:this.currentDate.getFullYear(),month:this.currentDate.getMonth()+1}},getFiltersContainer:function(){return this.$container.find(".ffc-calendar-filters")},destroy:function(){this.$container.off(),this.$container.empty()}}}(jQuery);