!function(e){"use strict";const n={rowCounter:0,init:function(){this.bindEvents(),this.initRowCounter()},initRowCounter:function(){const n=e("#ffc-working-hours-list tr").length;this.rowCounter=n},bindEvents:function(){e(document).on("click","#ffc-add-working-hour",this.addWorkingHour.bind(this)),e(document).on("click",".ffc-remove-hour",this.removeWorkingHour.bind(this)),e(document).on("change","#allow_cancellation",this.toggleCancellationHours),e(document).on("change","#ffc_visibility",this.toggleSchedulingVisibility)},addWorkingHour:function(n){n.preventDefault();const t=e("#ffc-working-hours-list"),i=this.rowCounter++;let o="";[{value:0,label:"Sunday"},{value:1,label:"Monday"},{value:2,label:"Tuesday"},{value:3,label:"Wednesday"},{value:4,label:"Thursday"},{value:5,label:"Friday"},{value:6,label:"Saturday"}].forEach(function(e){o+='<option value="'+e.value+'">'+e.label+"</option>"});const a=`\n                <tr>\n                    <td>\n                        <select name="ffc_calendar_working_hours[${i}][day]" required>\n                            ${o}\n                        </select>\n                    </td>\n                    <td>\n                        <input type="time" name="ffc_calendar_working_hours[${i}][start]" value="09:00" required />\n                    </td>\n                    <td>\n                        <input type="time" name="ffc_calendar_working_hours[${i}][end]" value="17:00" required />\n                    </td>\n                    <td>\n                        <button type="button" class="button ffc-remove-hour">Remove</button>\n                    </td>\n                </tr>\n            `;t.append(a)},removeWorkingHour:function(n){if(n.preventDefault(),!confirm(ffcSelfSchedulingEditor.strings.confirmDelete))return;const t=e(n.currentTarget).closest("tr");e("#ffc-working-hours-list tr").length<=1?alert("You must have at least one working hour configured."):t.fadeOut(300,function(){e(this).remove()})},toggleCancellationHours:function(){const n=e(this).is(":checked");e(".ffc-cancellation-hours").toggle(n)},toggleSchedulingVisibility:function(){const n=e("#ffc_visibility"),t=e("#ffc_scheduling_visibility"),i=e("#ffc-scheduling-desc");"private"===n.val()?(t.val("private").prop("disabled",!0),t.next('input[type="hidden"]').length||t.after('<input type="hidden" name="ffc_self_scheduling_config[scheduling_visibility]" value="private" />'),i.text(ffcSelfSchedulingEditor.strings.schedulingForced||"Forced to Private because Visibility is Private.")):(t.prop("disabled",!1),t.next('input[type="hidden"]').remove(),i.text(ffcSelfSchedulingEditor.strings.schedulingDesc||"Public: anyone can book. Private: only logged-in users can book."))},initCleanup:function(){e(document).on("click",".ffc-cleanup-btn",function(){const n=e(this),t=n.data("action"),i=n.data("calendar-id"),o="undefined"!=typeof ffcSelfSchedulingEditor?ffcSelfSchedulingEditor.strings:{};let a=o.confirmCleanup||"Are you sure you want to delete these appointments? This action cannot be undone.";"all"===t&&(a=o.confirmCleanupAll||"Are you sure you want to delete ALL appointments? This will permanently remove all appointment data and cannot be undone!"),confirm(a)&&(n.prop("disabled",!0).text(o.deleting||"Deleting..."),e.ajax({url:ajaxurl,method:"POST",data:{action:"ffc_cleanup_appointments",calendar_id:i,cleanup_action:t,nonce:e("#ffc_cleanup_appointments_nonce").val()},success:function(e){e.success?(alert(e.data.message),location.reload()):(alert(e.data.message||o.errorDeleting||"Error deleting appointments"),n.prop("disabled",!1))},error:function(){alert(o.errorServer||"Error communicating with server"),n.prop("disabled",!1)}}))})}};e(document).ready(function(){n.init(),n.initCleanup()})}(jQuery);