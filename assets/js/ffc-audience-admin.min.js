!function(e){"use strict";const n={init:function(){this.bindEvents()},bindEvents:function(){e(document).on("change",'.ffc-day-row input[type="checkbox"]',function(){e(this).closest(".ffc-day-row").find('input[type="time"]').prop("disabled",e(this).is(":checked"))}),this.initUserSearch(),this.initEnvironmentFilter()},initUserSearch:function(){var n=e("#user_search");if(n.length){var t,i={},a="undefined"!=typeof ffcAudienceAdmin?ffcAudienceAdmin.nonce:"";n.on("input",function(){clearTimeout(t);var n=e(this).val();n.length<2?e("#user_results").removeClass("active").empty():t=setTimeout(function(){e.ajax({url:ajaxurl,data:{action:"ffc_search_users",query:n,nonce:a},success:function(n){if(n.success&&n.data.length>0){var t="";n.data.forEach(function(e){i[e.id]||(t+='<div class="ffc-user-result" data-id="'+e.id+'" data-name="'+e.name+'">'+e.name+" ("+e.email+")</div>")}),e("#user_results").html(t).addClass("active")}else e("#user_results").removeClass("active").empty()}})},300)}),e(document).on("click",".ffc-user-result",function(){var t=e(this).data("id"),a=e(this).data("name");i[t]=a,s(),e("#user_results").removeClass("active").empty(),n.val("")}),e(document).on("click",".ffc-selected-user .remove",function(){var n=e(this).data("id");delete i[n],s()})}function s(){var n="",t=[];for(var a in i)n+='<span class="ffc-selected-user">'+i[a]+'<span class="remove" data-id="'+a+'">&times;</span></span>',t.push(a);e("#selected_users").html(n),e("#selected_user_ids").val(t.join(","))}},initEnvironmentFilter:function(){var n=e("#filter-schedule"),t=e("#filter-environment");if(n.length&&t.length){var i="undefined"!=typeof ffcAudienceAdmin?ffcAudienceAdmin.strings:{},a="undefined"!=typeof ffcAudienceAdmin?ffcAudienceAdmin.adminNonce:"",s=i.allEnvironments||"All Environments",c=i.loading||"Loading...";n.on("change",function(){var n=e(this).val();n?(t.html('<option value="">'+c+"</option>"),e.ajax({url:ajaxurl,type:"GET",data:{action:"ffc_audience_get_environments",schedule_id:n,nonce:a},success:function(n){if(n.success&&n.data){var i='<option value="">'+s+"</option>";e.each(n.data,function(n,t){i+='<option value="'+t.id+'">'+e("<div/>").text(t.name).html()+"</option>"}),t.html(i)}else t.html('<option value="">'+s+"</option>")},error:function(){t.html('<option value="">'+s+"</option>")}})):t.html('<option value="">'+s+"</option>")})}}};e(document).ready(function(){n.init()})}(jQuery);