!function(e){"use strict";window.FFC=window.FFC||{},window.FFC.Admin=window.FFC.Admin||{},window.FFC.Admin.showNotification=function(n,t,i){t=t||"info",i=i||5e3,e(".ffc-admin-notification").remove();var s=("undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).dismiss||"Dismiss",o=e('<div class="ffc-admin-notification notice '+{success:"notice-success",error:"notice-error",warning:"notice-warning",info:"notice-info"}[t]+' is-dismissible"><p><span class="dashicons dashicons-'+{success:"yes-alt",error:"dismiss",warning:"warning",info:"info"}[t]+'"></span> '+n+'</p><button type="button" class="notice-dismiss"><span class="screen-reader-text">'+s+"</span></button></div>");e(".wrap > h1").length?e(".wrap > h1").after(o):e("#wpbody-content").prepend(o),o.find(".notice-dismiss").on("click",function(){o.fadeOut(200,function(){e(this).remove()})}),i>0&&setTimeout(function(){o.fadeOut(200,function(){e(this).remove()})},i)},e(document).on("click","#ffc_btn_generate_codes",function(n){n.preventDefault();var t=e("#ffc_qty_codes").val();if(!t||isNaN(t)||t<1){var i=(s="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).enterValidNumber||"Please enter a valid number.";return e("#ffc_gen_status").text(i).css("color","red"),void e("#ffc_qty_codes").focus()}var s,o=e(this),c=e("#ffc_gen_status"),a=o.text(),r=(s="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{}).generating||"Generating...",f=s.generatingTickets||"Generating tickets...";o.prop("disabled",!0).text(r),c.text(f).css("color","#999");var d="undefined"!=typeof ffc_ajax?ffc_ajax.nonce:"";e.ajax({url:ajaxurl,type:"POST",data:{action:"ffc_generate_codes",qty:t,nonce:d},success:function(n){var i="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{};if(n.success){var s=e("#ffc_generated_list");if(s.length){var r=s.val(),f=r?r+"\n"+n.data.codes:n.data.codes;s.val(f);var d=i.ticketsGeneratedSuccess||"tickets generated successfully!";c.text("✓ "+t+" "+d).css("color","green"),setTimeout(function(){c.text("")},5e3)}else{console.warn("[FFC] Generated codes field not found");var l=i.codesFieldNotFound||"Error: codes field not found";c.text("✗ "+l).css("color","red")}}else{var u=i.error||"Error: ";c.text("✗ "+u+(n.data||"Unknown error")).css("color","red")}o.prop("disabled",!1).text(a)},error:function(e){console.error("[FFC] AJAX error:",e.status,e.statusText,e.responseText);var n="undefined"!=typeof ffc_ajax&&ffc_ajax.strings?ffc_ajax.strings:{},t="✗ ";if(403===e.status)t+=n.permissionDenied||"Permission denied. Please reload the page.";else if(400===e.status)t+=n.badRequest||"Bad request. Check console.";else{t+=(n.serverError||"Server error (Status: %d)").replace("%d",e.status)}c.text(t).css("color","red"),o.prop("disabled",!1).text(a)}})}),e(document).ready(function(){e("#ffc-fields-container").length&&(window.FFC&&window.FFC.Admin&&window.FFC.Admin.FieldBuilder?window.FFC.Admin.FieldBuilder.init():console.warn("[FFC Admin] Field Builder module not loaded"))}),jQuery(document).ready(function(e){e("#ffc-migrations-overlay").length||e("body").append('<div id="ffc-migrations-overlay" class="ffc-migrations-overlay"></div>');var n=e("#ffc-migrations-btn"),t=e("#ffc-migrations-menu"),i=e("#ffc-migrations-overlay");function s(){t.removeClass("ffc-visible"),i.removeClass("ffc-visible")}function o(n,t){e(n).is(":checked")?e(t).slideDown():e(t).slideUp()}n.length&&t.length&&(n.on("click",function(n){n.preventDefault(),n.stopPropagation(),t.hasClass("ffc-visible")?s():(e(".ffc-migrations-menu").not(t).removeClass("ffc-visible"),i.addClass("ffc-visible"),t.addClass("ffc-visible"))}),i.on("click",function(e){e.preventDefault(),e.stopPropagation(),s()}),e(document).on("click",function(n){e(n.target).closest(".ffc-migrations-dropdown").length||s()}),e(document).on("keydown",function(e){"Escape"!==e.key&&27!==e.keyCode||t.hasClass("ffc-visible")&&s()}),t.on("click",function(e){e.stopPropagation()}),e(document).on("change","#ffc_restriction_password",function(){o(this,"#ffc_password_field")}),e("#ffc_restriction_password").trigger("change"),e(document).on("change","#ffc_restriction_allowlist",function(){o(this,"#ffc_allowlist_field")}),e("#ffc_restriction_allowlist").trigger("change"),e(document).on("change","#ffc_restriction_denylist",function(){o(this,"#ffc_denylist_field")}),e("#ffc_restriction_denylist").trigger("change"),e(document).on("change","#ffc_restriction_ticket",function(){o(this,"#ffc_ticket_field")}),e("#ffc_restriction_ticket").trigger("change"))})}(jQuery);